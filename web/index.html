<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <title>CRISPR Cut Browser</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700" rel="stylesheet">
    <link href="/style.css" rel="stylesheet">

    <script src="/dist/bundle.js"></script>
</head>
<body>
<div id="advanced-search-container" class="modal-container">
    <div id="advanced-search-modal" class="modal">
        <button id="hide-advanced-search" class="close-modal"><span class="material-icons">close</span></button>
        <div id="advanced-search-modal-scroll-container" class="modal-scroll-container">
            <h2>
                Advanced Search
                <button id="toggle-advanced-search-help" class="toggle-modal-help">
                    <span class="material-icons">help</span>
                </button>
            </h2>
            <div id="advanced-search-help">
                <p>
                    The advanced search mechanism allows for complex filtering of variants in the database by allowing
                    the user to create a <strong>set of rules</strong> that determine if a variant entry is or is not
                    allowed the result set.
                </p>
                <p>
                    To begin, add at least one condition with the "Add Condition" button in the bottom left of the modal
                    window. This adds a set of fields which can be used to create a <strong>single rule</strong>
                    applying to a <strong>specific column</strong> in the database. The fields are broken down as
                    follows: 1) An optional negation field that takes the rest of the condition and inverts it. For
                    example, if the current condition is "gene_info contains 'LOC'", then this would turn the condition
                    into "gene_info <strong>does not</strong> contain 'LOC'". 2) A field drop-down which specifies which
                    field the condition should apply to. 3) An operator for the condition. This relates the selected
                    field with the value entered into the text box on the right (4).
                </p>
                <p>
                    For example, take the <strong>gene_info</strong> field. This field allows 9 different operators:
                    equals, 4 inequality operators, starts/ends with, and contains. In this case, the
                    <strong>contains</strong> operator is helpful. If the string "LOC" is being searched in the
                    <strong>gene_info</strong> field, the <strong>contains</strong> operator would yield positive
                    matches with, for example, "<em>LOC</em>105378947:105378947" or
                    "KAZN:23254|<em>LOC</em>107985467:107985467". If the <strong>starts_with</strong> operator was used,
                    only the first example would match.
                </p>
                <p>
                    In this way, multiple rules can be strung together into a query. When the query is built, an
                    encoded version can be saved by pressing the "Save" button, which will clear and re-populate the
                    search field with a machine-readable version of the query. The query can then be optionally combined
                    with "quick filters" in the sidebar before being used to filter the variants.
                </p>
            </div>
            <p style="margin-top: 0;">
                <strong>Order of Boolean Operations:</strong>
                In chains of <strong>AND</strong> and <strong>OR</strong>, <strong>AND</strong> takes precedence. For
                example, the following are equivalent:
            </p>
            <div class="code-comparison">
                <code>
                    cond_1 <strong>OR</strong>
                    cond_2 <strong>AND</strong> cond_3 <strong>OR</strong>
                    cond_4 <strong>AND</strong> cond_5 <strong>AND</strong> cond_6</code>
                <code>
                    cond_1 <strong>OR</strong>
                    <strong>(</strong>cond_2 <strong>AND</strong> cond_3<strong>)</strong> <strong>OR</strong>
                    <strong>(</strong>cond_4 <strong>AND</strong> cond_5 <strong>AND</strong> cond_6<strong>)</strong>
                </code>
            </div>
            <ul id="advanced-search-conditions"></ul>
        </div>
        <div id="advanced-search-modal-options" class="modal-options">
            <div>
                <button id="add-search-condition" class="with-icon">
                    <span class="material-icons">add</span> Add Condition
                </button>
            </div>
            <div>
                <button id="save-search-query" class="with-icon">
                    <span class="material-icons">save</span> Save
                </button>
            </div>
        </div>
    </div>
</div>
<div id="export-options-container" class="modal-container">
    <div id="export-options-modal" class="modal">
        <button id="hide-export" class="close-modal"><span class="material-icons">close</span></button>
        <div class="modal-scroll-container">
            <h2>Export Options</h2>
            <p>
                <strong>Total Matching Variants:</strong> <span id="matching-variants-export">0</span>
            </p>
            <form>
                <label for="export-format">Export Format:</label>
                <select name="export-format" id="export-format">
                    <option value="tsv">TSV</option>
                </select>
            </form>
        </div>
        <div class="modal-options">
            <div></div>
            <div>
                <button id="export-variants">Export Variants</button>
                <button id="export-cut-sites" disabled>Export Cut Sites</button>
            </div>
        </div>
    </div>
</div>
<main>
<section id="table-display" class="loading">
    <table id="entry-table"><thead></thead><tbody></tbody></table>
</section>
<section id="table-pagination">
    <div>
        <label for="items-per-page">
            Items Per Page:
            <select name="items-per-page" id="items-per-page">
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100" selected>100</option>
                <option value="250">250</option>
                <option value="500">500</option>
                <option value="1000">1000</option>
                <option value="999999999999">All Matches</option>
            </select>
        </label>
    </div>
    <div>
        Page <span id="current-page">0</span> of <span id="total-pages">0</span>
        <span id="total-entries-text">(<span id="total-entries">0</span> entries)</span>
    </div>
    <div style="font-size: 0;">
        <button id="show-export">Export Matches...</button>
        <div class="vr"></div>
        <button id="first-page" class="icon-button" disabled>
            <span class="material-icons">first_page</span>
        </button>
        <div class="button-row">
            <button id="prev-page" class="icon-button" disabled>
                <span class="material-icons">chevron_left</span>
            </button>
            <button id="next-page" class="icon-button" disabled>
                <span class="material-icons">chevron_right</span>
            </button>
        </div>
        <button id="last-page" class="icon-button" disabled>
            <span class="material-icons">last_page</span>
        </button>
    </div>
</section>
</main>
<aside id="filter-options">
    <div id="app-logo-container">
        <img src="/logo.png" alt="CRISPR Cut Browser Logo" id="app-logo">
    </div>
    <h1>CRISPR Cut Browser</h1>
    <form id="filter-search-form">
        <h2>QUICK FILTERS</h2>
        <h3>Chromosome</h3>
        <div id="chromosome-checkboxes"></div>
        <label for="start">Start Position</label>
        <input type="number" min="" max="" id="start" name="start">
        <label for="end">End Position</label>
        <input type="number" min="" max="" id="end" name="end">
        <!--<label for="position-filter-operator">Position Filter Type</label>-->
        <!--<select name="position-filter-operator" id="position-filter-operator"></select>-->
        <h3>Gene Location</h3>
        <div id="gene-location-checkboxes"></div>
        <hr>
        <label for="min-mh-l">Minimum mhL Value</label>
        <input type="number" min="0" value="0" id="min-mh-l" name="min-mh-l" >
        <hr>
        <h3>Database Sources</h3>
        <label for="dbsnp" class="checkbox-label">
            <input type="checkbox" id="dbsnp" name="dbsnp" checked> Must be in dbSNP
        </label>
        <label for="clinvar" class="checkbox-label">
            <input type="checkbox" id="clinvar" name="clinvar" checked> Must be in ClinVar
        </label>
        <hr>
        <h2><label for="search-query">SEARCH</label></h2>
        <input type="text" name="search-query" id="search-query" placeholder="Query all fields...">
        <div class="row">
            <h3 style="margin: 0; padding-right: 0.6em; line-height: 39px;">OR</h3>
            <button id="show-advanced-search" type="button" class="col"
                    style="margin: 5px 0;">Advanced Search</button>
        </div>
        <hr>
        <button id="apply-filters" type="submit">Apply Filters</button>
        <button id="clear-filters" type="button">Clear Filters</button>
    </form>
</aside>
</body>
</html>
